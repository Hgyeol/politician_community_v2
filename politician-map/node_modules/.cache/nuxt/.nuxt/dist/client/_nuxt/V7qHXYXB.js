import{h as k,m as h,G as V,r as b,i as S,U as q,e as U,c as u,a as e,g as M,y as d,V as g,F as B,v as C,u as v,W as F,z as f,t as r,x as N,o as p}from"./CmVufc-E.js";import{u as P}from"./DviHxHOA.js";import{u as z}from"./gLgMcFAZ.js";import"./DP_pfCD1.js";const D={class:"max-w-4xl mx-auto px-4 sm:px-6 lg:px-8 py-8"},E={class:"mb-6"},R=["value"],$={class:"mb-6"},A={class:"mb-6"},G={class:"mt-1 text-sm text-gray-500"},I={class:"mb-6"},L={class:"mt-1 text-sm text-gray-500"},T={key:0,class:"mb-6 p-4 bg-red-50 border border-red-200"},W={class:"text-red-700"},j={class:"flex gap-4"},H=["disabled"],Y=k({__name:"new",setup(J){const c=h(),m=V(),{politicians:y,loadPoliticians:x}=P(),{createSuggestion:w}=z(),o=b({politician_id:"",category:"",title:"",content:""}),a=b(!1),i=b("");function n(){o.value={politician_id:m.query.politician_id||"",category:"",title:"",content:""},a.value=!1,i.value=""}S(async()=>{await x(),n()}),q(()=>{n()}),U(()=>m.fullPath,l=>{l==="/suggestions/new"&&n()},{immediate:!0});async function _(){if(!a.value){i.value="",a.value=!0;try{const{data:l,error:t}=await w({title:o.value.title,content:o.value.content,category:o.value.category,politician_id:parseInt(o.value.politician_id)});if(t){i.value=t;return}l&&(n(),c.push(`/suggestions/${l.id}`))}catch(l){i.value=l.message||"건의사항 작성 중 오류가 발생했습니다"}finally{a.value===!0&&(a.value=!1)}}}return(l,t)=>(p(),u("div",D,[t[11]||(t[11]=e("div",{class:"mb-8"},[e("h1",{class:"text-3xl font-bold text-gray-900 mb-2"},"건의사항 작성"),e("p",{class:"text-gray-600"},"정치인에게 전달할 건의사항을 작성해주세요")],-1)),e("form",{onSubmit:N(_,["prevent"]),class:"bg-white border border-gray-200 p-8"},[e("div",E,[t[6]||(t[6]=e("label",{class:"block text-sm font-semibold text-gray-700 mb-2"}," 정치인 선택 * ",-1)),d(e("select",{"onUpdate:modelValue":t[0]||(t[0]=s=>o.value.politician_id=s),required:"",class:"w-full px-4 py-3 border border-gray-300 focus:ring-2 focus:ring-blue-500 focus:border-transparent"},[t[5]||(t[5]=e("option",{value:""},"정치인을 선택하세요",-1)),(p(!0),u(B,null,C(v(y),s=>(p(),u("option",{key:s.id,value:s.id},r(s.의원명)+" ("+r(s.지역)+", "+r(s.정당)+") ",9,R))),128))],512),[[g,o.value.politician_id]])]),e("div",$,[t[8]||(t[8]=e("label",{class:"block text-sm font-semibold text-gray-700 mb-2"}," 카테고리 * ",-1)),d(e("select",{"onUpdate:modelValue":t[1]||(t[1]=s=>o.value.category=s),required:"",class:"w-full px-4 py-3 border border-gray-300 focus:ring-2 focus:ring-blue-500 focus:border-transparent"},[...t[7]||(t[7]=[F('<option value="">카테고리를 선택하세요</option><option value="경제">경제</option><option value="교육">교육</option><option value="환경">환경</option><option value="복지">복지</option><option value="안전">안전</option><option value="교통">교통</option><option value="문화">문화</option><option value="기타">기타</option>',9)])],512),[[g,o.value.category]])]),e("div",A,[t[9]||(t[9]=e("label",{class:"block text-sm font-semibold text-gray-700 mb-2"}," 제목 * ",-1)),d(e("input",{"onUpdate:modelValue":t[2]||(t[2]=s=>o.value.title=s),type:"text",required:"",maxlength:"100",placeholder:"건의사항 제목을 입력하세요",class:"w-full px-4 py-3 border border-gray-300 focus:ring-2 focus:ring-blue-500 focus:border-transparent"},null,512),[[f,o.value.title]]),e("p",G,r(o.value.title.length)+"/100",1)]),e("div",I,[t[10]||(t[10]=e("label",{class:"block text-sm font-semibold text-gray-700 mb-2"}," 내용 * ",-1)),d(e("textarea",{"onUpdate:modelValue":t[3]||(t[3]=s=>o.value.content=s),required:"",rows:"10",maxlength:"2000",placeholder:"건의사항 내용을 상세히 작성해주세요",class:"w-full px-4 py-3 border border-gray-300 focus:ring-2 focus:ring-blue-500 focus:border-transparent resize-none"},null,512),[[f,o.value.content]]),e("p",L,r(o.value.content.length)+"/2000",1)]),i.value?(p(),u("div",T,[e("p",W,r(i.value),1)])):M("",!0),e("div",j,[e("button",{type:"submit",disabled:a.value,class:"flex-1 px-6 py-3 bg-gray-800 text-white font-semibold hover:bg-gray-900 transition-colors disabled:bg-gray-400 disabled:cursor-not-allowed"},r(a.value?"작성 중...":"작성 완료"),9,H),e("button",{type:"button",onClick:t[4]||(t[4]=s=>v(c).back()),class:"px-6 py-3 bg-gray-200 text-gray-700 font-semibold hover:bg-gray-300 transition-colors"}," 취소 ")])],32)]))}});export{Y as default};
