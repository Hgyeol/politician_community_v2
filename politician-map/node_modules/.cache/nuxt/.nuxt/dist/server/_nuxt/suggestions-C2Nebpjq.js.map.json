{"file":"suggestions-C2Nebpjq.js","mappings":";;;;;;;;;;;;;;;;;;;;;;AAyIA,UAAM,QAAQ,SAAA;AACC,cAAA;AACf,UAAM,EAAE,gBAAA,IAAoB,QAAA;AAC5B,UAAM,EAAE,aAAAA,cAAa,SAAS,QAAyB,IAAI,eAAA;AAClB,mBAAA;AAEzC,UAAM,eAAe,SAAS,MAAM,OAAO,EAAY;AACvD,UAAM,aAAa,IAAI,IAAI;AAC3B,UAAM,oBAAoB,IAAI,IAAI;AACV,QAAI,IAAI;AAIhC,UAAM,2BAA2B,CAAC,OAAO,OAAO,OAAO,MAAM;AAC7D,UAAM,6BAA6B,IAAI,CAAC;AACxC,UAAM,qBAAqB,SAAS,MAAM;AACxC,UAAI,CAAC,WAAW,MAAO,QAAO;AAC9B,YAAM,OAAO,WAAW,MAAM;AAC9B,YAAM,MAAM,yBAAyB,2BAA2B,KAAK;AACrE,aAAO,UAAU,IAAI,IAAI,GAAG;AAAA,IAC9B,CAAC;AACD,UAAM,cAAc,IAAI,KAAK;AAgD7B,aAAS,WAAW,YAAoB;AACtC,YAAM,OAAO,IAAI,KAAK,UAAU;AAChC,YAAM,0BAAU,KAAA;AAChB,YAAM,gBAAgB,KAAK,OAAO,IAAI,YAAY,KAAK,QAAA,KAAa,GAAI;AAExE,UAAI,gBAAgB,GAAI,QAAO;AAC/B,UAAI,gBAAgB,KAAM,QAAO,GAAG,KAAK,MAAM,gBAAgB,EAAE,CAAC;AAClE,UAAI,gBAAgB,MAAO,QAAO,GAAG,KAAK,MAAM,gBAAgB,IAAI,CAAC;AACrE,UAAI,gBAAgB,OAAQ,QAAO,GAAG,KAAK,MAAM,gBAAgB,KAAK,CAAC;AAEvE,aAAO,KAAK,mBAAmB,SAAS;AAAA,QACtC,MAAM;AAAA,QACN,OAAO;AAAA,QACP,KAAK;AAAA,MAAA,CACN;AAAA,IACH;;;AA5NO,YAAA,OAAAC,eAAAC,WAAA,EAAA,OAAM,iDAA6C,MAAA,CAAA,CAAA,mBAAA;UAE3C,kBAAA,OAAiB;;iBAIZ,WAAA,OAAU;;aAOT,YAAA,OAAW;uBACjBC,cAAA,OAAKC,MAAA,kBAAA,CAAkB,kBACvB,OAAK,WAAA,MAAW,GAAG;;;;kIAU+BC,eAAA,WAAA,MAAW,GAAG,kQAICA,eAAA,WAAA,MAAW,EAAE,gOAIbA,eAAA,WAAA,MAAW,EAAE,mOAIbA,eAAA,WAAA,MAAW,KAAK,gOAIhBA,eAAA,WAAA,MAAW,IAAI;AAAmB,YAAA,WAAA,MAAW,MAAI;AAAO,gBAAA,aAAAA,eAAA,WAAA,MAAW,IAAI,CAAA,WAAA;AAAA;;;;YAgBvID,MAAA,eAAA,GAAe;;YACpB,sCAAsCA,MAAA,YAAA,CAAY;AAAA,YACnD,OAAM;AAAA,UAAA;6BAHR,CAMW,GAAAE,QAAAC,UAAA,aAAA;;;;;kCAFV,WAED;AAAA,gBAAA;AAAA;;;;;;YAGE,IAAG;AAAA,YACH,OAAM;AAAA,UAAA;6BAHR,CAMW,GAAAD,QAAAC,UAAA,aAAA;;;;;kCAFV,cAED;AAAA,gBAAA;AAAA;;;;;;AAMuBC,sBAAAJ,MAAAJ,YAAA,IAAd,eAAU;6OAOVK,eAAA,WAAW,KAAK,mGAGhBA,eAAA,WAAW,QAAQ,4EAKrBA,eAAA,WAAW,OAAO,+MAKU,WAAW,UAAU,YAAQ,IAAA,mGAG9CA,eAAA,WAAW,cAAU,CAAA,gDACxB,WAAW,WAAW,UAAU,CAAA;;;YAMpCD,MAAA,OAAA,GAAO;;;;;AAKP,YAAAA,MAAA,OAAA,MAAYA,MAAA,OAAA,GAAO;;;;;aAUlBA,MAAA,OAAA,KAAWA,MAAAJ,YAAA,EAAY,WAAM,GAAA;;;;;;;;;;;;;;;;;;;;","names":["suggestions","_ssrRenderAttrs","_mergeProps","_ssrRenderAttr","_unref","_ssrInterpolate","_push","_parent","_ssrRenderList"],"sources":["../../../../../../../pages/politicians/[id]/suggestions.vue"],"sourcesContent":["<template>\n  <div class=\"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8\">\n    <!-- 로딩 상태 -->\n    <div v-if=\"politicianLoading\" class=\"text-center py-16\">\n      <div class=\"inline-block animate-spin h-12 w-12 border-b-2 border-gray-800\"></div>\n    </div>\n\n    <div v-else-if=\"politician\">\n      <!-- 정치인 정보 헤더 -->\n      <div class=\"bg-white border border-gray-200 p-8 mb-8\">\n        <div class=\"flex items-center justify-between\">\n          <!-- Politician Image -->\n          <div class=\"flex-shrink-0 mx-auto mb-8 w-[200px] h-[240px] overflow-hidden border border-gray-200\">\n            <img\n              v-if=\"!imageFailed\"\n              :src=\"politicianImageSrc\"\n              :alt=\"politician.의원명\"\n              class=\"w-full h-full object-cover\"\n              @error=\"handleImageError\"\n            />\n            <div v-else class=\"w-full h-full bg-gray-200 flex items-center justify-center text-gray-500 text-sm\">\n              사진 없음\n            </div>\n          </div>\n\n          <div class=\"flex-1 pl-6\">\n            <h2 class=\"text-3xl font-bold text-gray-900 mb-6\">{{ politician.의원명 }} 의원</h2>\n            <div class=\"space-y-2\">\n              <div class=\"flex py-4\">\n                <span class=\"font-semibold text-gray-600 min-w-[100px] text-base\">지역</span>\n                <span class=\"flex-1 text-gray-800 text-base leading-relaxed\">{{ politician.지역 }}</span>\n              </div>\n              <div class=\"flex py-4\">\n                <span class=\"font-semibold text-gray-600 min-w-[100px] text-base\">정당</span>\n                <span class=\"flex-1 text-gray-800 text-base leading-relaxed\">{{ politician.정당 }}</span>\n              </div>\n              <div class=\"flex py-4\">\n                <span class=\"font-semibold text-gray-600 min-w-[100px] text-base\">소속위원회</span>\n                <span class=\"flex-1 text-gray-800 text-base leading-relaxed\">{{ politician.소속위원회 }}</span>\n              </div>\n              <div class=\"flex py-4\">\n                <span class=\"font-semibold text-gray-600 min-w-[100px] text-base\">당선</span>\n                <span class=\"flex-1 text-gray-800 text-base leading-relaxed\">{{ politician.당선횟수 }}<template v-if=\"politician.당선방법\"> ({{ politician.당선방법 }})</template></span>\n              </div>\n            </div>\n          </div>\n        </div>\n      </div>\n\n      <!-- 작성 버튼 -->\n      <div class=\"mb-6 flex justify-between items-center\">\n        <button\n          @click=\"router.back()\"\n          class=\"text-gray-600 hover:text-gray-900 font-medium\"\n        >\n          ← 돌아가기\n        </button>\n        <NuxtLink\n          v-if=\"isAuthenticated\"\n          :to=\"`/suggestions/new?politician_id=${politicianId}`\"\n          class=\"px-6 py-3 bg-gray-800 text-white font-medium hover:bg-gray-900 transition-colors\"\n        >\n          건의사항 작성\n        </NuxtLink>\n        <NuxtLink\n          v-else\n          to=\"/auth/login\"\n          class=\"px-6 py-3 bg-gray-600 text-white font-medium hover:bg-gray-700 transition-colors\"\n        >\n          로그인하여 작성하기\n        </NuxtLink>\n      </div>\n\n      <!-- 건의사항 목록 -->\n      <div class=\"space-y-4\">\n        <div\n          v-for=\"suggestion in suggestions\"\n          :key=\"suggestion.id\"\n          class=\"bg-white border border-gray-200 p-6 cursor-pointer\"\n          @click=\"navigateToDetail(suggestion.id)\"\n        >\n          <div class=\"flex justify-between items-start mb-3\">\n            <h2 class=\"text-xl font-semibold text-gray-900 flex-1\">\n              {{ suggestion.title }}\n            </h2>\n            <span class=\"ml-4 px-3 py-1 bg-gray-50 text-gray-700 text-sm font-medium\">\n              {{ suggestion.category }}\n            </span>\n          </div>\n\n          <p class=\"text-gray-600 mb-4 line-clamp-2\">\n            {{ suggestion.content }}\n          </p>\n\n          <div class=\"flex items-center justify-between text-sm text-gray-500\">\n            <div class=\"flex items-center space-x-4\">\n              <span class=\"font-medium\">{{ suggestion.profiles?.nickname || '익명' }}</span>\n            </div>\n            <div class=\"flex items-center space-x-4\">\n              <span>조회 {{ suggestion.view_count || 0 }}</span>\n              <span>{{ formatDate(suggestion.created_at) }}</span>\n            </div>\n          </div>\n        </div>\n\n        <!-- 로딩 상태 -->\n        <div v-if=\"loading\" class=\"text-center py-8\">\n          <div class=\"inline-block animate-spin h-8 w-8 border-b-2 border-gray-800\"></div>\n        </div>\n\n        <!-- 더 보기 -->\n        <div v-if=\"hasMore && !loading\" ref=\"loadMoreTrigger\" class=\"text-center py-8\">\n          <button\n            @click=\"loadMore({ politician_id: politicianId })\"\n            class=\"px-6 py-3 bg-gray-100 text-gray-700 font-medium hover:bg-gray-200 transition-colors\"\n          >\n            더 보기\n          </button>\n        </div>\n\n        <!-- 빈 상태 -->\n        <div v-if=\"!loading && suggestions.length === 0\" class=\"text-center py-16\">\n          <p class=\"text-gray-500 text-lg\">아직 작성된 건의사항이 없습니다</p>\n        </div>\n      </div>\n    </div>\n\n    <div v-else class=\"text-center py-16\">\n      <p class=\"text-gray-500 text-lg\">정치인 정보를 찾을 수 없습니다</p>\n    </div>\n  </div>\n</template>\n\n<script setup lang=\"ts\">\nimport { ref, onMounted, onUnmounted } from 'vue'\n\n\nconst route = useRoute()\nconst router = useRouter()\nconst { isAuthenticated } = useAuth()\nconst { suggestions, hasMore, loading, loadMore, reset } = useSuggestions()\nconst { politicians, loadPoliticians } = usePoliticians()\n\nconst politicianId = parseInt(route.params.id as string)\nconst politician = ref(null)\nconst politicianLoading = ref(true)\nconst loadMoreTrigger = ref(null)\nlet observer = null\n\n// Image handling\nconst availableImageExtensions = ['jpg', 'png', 'gif', 'jpeg'];\nconst currentImageExtensionIndex = ref(0);\nconst politicianImageSrc = computed(() => {\n  if (!politician.value) return '';\n  const name = politician.value.의원명;\n  const ext = availableImageExtensions[currentImageExtensionIndex.value];\n  return `/image/${name}.${ext}`;\n});\nconst imageFailed = ref(false);\n\nconst handleImageError = () => {\n  if (currentImageExtensionIndex.value < availableImageExtensions.length - 1) {\n    currentImageExtensionIndex.value++; // Try next extension\n  } else {\n    imageFailed.value = true; // All extensions tried, set to failed\n  }\n};\n\n\nonMounted(async () => {\n  // 정치인 정보 로드\n  await loadPoliticians()\n  politician.value = politicians.value.find(p => p.id === politicianId)\n  politicianLoading.value = false\n\n  // 건의사항 로드\n  await loadMore({ politician_id: politicianId })\n\n  // Intersection Observer 설정 (무한 스크롤)\n  if (typeof IntersectionObserver !== 'undefined') {\n    observer = new IntersectionObserver(\n      (entries) => {\n        if (entries[0].isIntersecting && hasMore.value && !loading.value) {\n          loadMore({ politician_id: politicianId })\n        }\n      },\n      { threshold: 0.1 }\n    )\n\n    if (loadMoreTrigger.value) {\n      observer.observe(loadMoreTrigger.value)\n    }\n  }\n})\n\nonUnmounted(() => {\n  if (observer) {\n    observer.disconnect()\n  }\n  reset()\n})\n\nfunction navigateToDetail(id: number) {\n  router.push(`/suggestions/${id}`)\n}\n\nfunction formatDate(dateString: string) {\n  const date = new Date(dateString)\n  const now = new Date()\n  const diffInSeconds = Math.floor((now.getTime() - date.getTime()) / 1000)\n\n  if (diffInSeconds < 60) return '방금 전'\n  if (diffInSeconds < 3600) return `${Math.floor(diffInSeconds / 60)}분 전`\n  if (diffInSeconds < 86400) return `${Math.floor(diffInSeconds / 3600)}시간 전`\n  if (diffInSeconds < 604800) return `${Math.floor(diffInSeconds / 86400)}일 전`\n\n  return date.toLocaleDateString('ko-KR', {\n    year: 'numeric',\n    month: 'long',\n    day: 'numeric'\n  })\n}\n</script>\n\n<style scoped>\n.line-clamp-2 {\n  display: -webkit-box;\n  -webkit-line-clamp: 2;\n  -webkit-box-orient: vertical;\n  overflow: hidden;\n}\n</style>\n"],"version":3}