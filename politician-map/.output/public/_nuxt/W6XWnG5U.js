import{_ as F}from"./DA1Fcrqp.js";import{h as V,G as A,m as O,r as c,H as P,i as G,R as H,c as a,a as e,u as i,t as l,d as p,g as m,F as $,f as M,w as j,v as K,o,_ as U}from"./CmVufc-E.js";import{u as q}from"./DivXWrku.js";import{u as z}from"./gLgMcFAZ.js";import{u as J}from"./DviHxHOA.js";import"./DP_pfCD1.js";const Q={class:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8"},W={key:0,class:"text-center py-16"},X={key:1},Y={class:"bg-white border border-gray-200 p-8 mb-8"},Z={class:"flex items-center justify-between"},ee={class:"flex-shrink-0 mx-auto mb-8 w-[200px] h-[240px] overflow-hidden border border-gray-200"},te=["src","alt"],se={key:1,class:"w-full h-full bg-gray-200 flex items-center justify-center text-gray-500 text-sm"},oe={class:"flex-1 pl-6"},ne={class:"text-3xl font-bold text-gray-900 mb-6"},ae={class:"space-y-2"},ie={class:"flex py-4"},le={class:"flex-1 text-gray-800 text-base leading-relaxed"},re={class:"flex py-4"},de={class:"flex-1 text-gray-800 text-base leading-relaxed"},ce={class:"flex py-4"},ue={class:"flex-1 text-gray-800 text-base leading-relaxed"},xe={class:"flex py-4"},pe={class:"flex-1 text-gray-800 text-base leading-relaxed"},me={class:"mb-6 flex justify-between items-center"},fe={class:"space-y-4"},ge=["onClick"],ye={class:"flex justify-between items-start mb-3"},_e={class:"text-xl font-semibold text-gray-900 flex-1"},ve={class:"ml-4 px-3 py-1 bg-gray-50 text-gray-700 text-sm font-medium"},be={class:"text-gray-600 mb-4 line-clamp-2"},he={class:"flex items-center justify-between text-sm text-gray-500"},we={class:"flex items-center space-x-4"},ke={class:"font-medium"},Ie={class:"flex items-center space-x-4"},$e={key:0,class:"text-center py-8"},Me={key:2,class:"text-center py-16"},je={key:2,class:"text-center py-16"},Ce=V({__name:"suggestions",setup(De){const C=A(),v=O(),{isAuthenticated:D}=q(),{suggestions:b,hasMore:h,loading:u,loadMore:f,reset:T}=z(),{politicians:E,loadPoliticians:S}=J(),d=parseInt(C.params.id),n=c(null),w=c(!0),g=c(null);let x=null;const k=["jpg","png","gif","jpeg"],y=c(0),B=P(()=>{if(!n.value)return"";const r=n.value.의원명,t=k[y.value];return`/image/${r}.${t}`}),I=c(!1),L=()=>{y.value<k.length-1?y.value++:I.value=!0};G(async()=>{await S(),n.value=E.value.find(r=>r.id===d),w.value=!1,await f({politician_id:d}),typeof IntersectionObserver<"u"&&(x=new IntersectionObserver(r=>{r[0].isIntersecting&&h.value&&!u.value&&f({politician_id:d})},{threshold:.1}),g.value&&x.observe(g.value))}),H(()=>{x&&x.disconnect(),T()});function N(r){v.push(`/suggestions/${r}`)}function R(r){const t=new Date(r),s=Math.floor((new Date().getTime()-t.getTime())/1e3);return s<60?"방금 전":s<3600?`${Math.floor(s/60)}분 전`:s<86400?`${Math.floor(s/3600)}시간 전`:s<604800?`${Math.floor(s/86400)}일 전`:t.toLocaleDateString("ko-KR",{year:"numeric",month:"long",day:"numeric"})}return(r,t)=>{const _=F;return o(),a("div",Q,[w.value?(o(),a("div",W,[...t[2]||(t[2]=[e("div",{class:"inline-block animate-spin h-12 w-12 border-b-2 border-gray-800"},null,-1)])])):n.value?(o(),a("div",X,[e("div",Y,[e("div",Z,[e("div",ee,[I.value?(o(),a("div",se," 사진 없음 ")):(o(),a("img",{key:0,src:i(B),alt:n.value.의원명,class:"w-full h-full object-cover",onError:L},null,40,te))]),e("div",oe,[e("h2",ne,l(n.value.의원명)+" 의원",1),e("div",ae,[e("div",ie,[t[3]||(t[3]=e("span",{class:"font-semibold text-gray-600 min-w-[100px] text-base"},"지역",-1)),e("span",le,l(n.value.지역),1)]),e("div",re,[t[4]||(t[4]=e("span",{class:"font-semibold text-gray-600 min-w-[100px] text-base"},"정당",-1)),e("span",de,l(n.value.정당),1)]),e("div",ce,[t[5]||(t[5]=e("span",{class:"font-semibold text-gray-600 min-w-[100px] text-base"},"소속위원회",-1)),e("span",ue,l(n.value.소속위원회),1)]),e("div",xe,[t[6]||(t[6]=e("span",{class:"font-semibold text-gray-600 min-w-[100px] text-base"},"당선",-1)),e("span",pe,[p(l(n.value.당선횟수),1),n.value.당선방법?(o(),a($,{key:0},[p(" ("+l(n.value.당선방법)+")",1)],64)):m("",!0)])])])])])]),e("div",me,[e("button",{onClick:t[0]||(t[0]=s=>i(v).back()),class:"text-gray-600 hover:text-gray-900 font-medium"}," ← 돌아가기 "),i(D)?(o(),M(_,{key:0,to:`/suggestions/new?politician_id=${i(d)}`,class:"px-6 py-3 bg-gray-800 text-white font-medium hover:bg-gray-900 transition-colors"},{default:j(()=>[...t[7]||(t[7]=[p(" 건의사항 작성 ",-1)])]),_:1},8,["to"])):(o(),M(_,{key:1,to:"/auth/login",class:"px-6 py-3 bg-gray-600 text-white font-medium hover:bg-gray-700 transition-colors"},{default:j(()=>[...t[8]||(t[8]=[p(" 로그인하여 작성하기 ",-1)])]),_:1}))]),e("div",fe,[(o(!0),a($,null,K(i(b),s=>(o(),a("div",{key:s.id,class:"bg-white border border-gray-200 p-6 cursor-pointer",onClick:Te=>N(s.id)},[e("div",ye,[e("h2",_e,l(s.title),1),e("span",ve,l(s.category),1)]),e("p",be,l(s.content),1),e("div",he,[e("div",we,[e("span",ke,l(s.profiles?.nickname||"익명"),1)]),e("div",Ie,[e("span",null,"조회 "+l(s.view_count||0),1),e("span",null,l(R(s.created_at)),1)])])],8,ge))),128)),i(u)?(o(),a("div",$e,[...t[9]||(t[9]=[e("div",{class:"inline-block animate-spin h-8 w-8 border-b-2 border-gray-800"},null,-1)])])):m("",!0),i(h)&&!i(u)?(o(),a("div",{key:1,ref_key:"loadMoreTrigger",ref:g,class:"text-center py-8"},[e("button",{onClick:t[1]||(t[1]=s=>i(f)({politician_id:i(d)})),class:"px-6 py-3 bg-gray-100 text-gray-700 font-medium hover:bg-gray-200 transition-colors"}," 더 보기 ")],512)):m("",!0),!i(u)&&i(b).length===0?(o(),a("div",Me,[...t[10]||(t[10]=[e("p",{class:"text-gray-500 text-lg"},"아직 작성된 건의사항이 없습니다",-1)])])):m("",!0)])])):(o(),a("div",je,[...t[11]||(t[11]=[e("p",{class:"text-gray-500 text-lg"},"정치인 정보를 찾을 수 없습니다",-1)])]))])}}}),Fe=U(Ce,[["__scopeId","data-v-2b897f62"]]);export{Fe as default};
